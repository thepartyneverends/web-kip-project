<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Вход в учетную запись</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<style>
    .form-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 0 30px rgba(0,0,0,0.1);
    }
    .form-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 15px 15px 0 0;
    }
    .required-label::after {
        content: " *";
        color: #dc3545;
    }
    .form-section {
        border-left: 4px solid #667eea;
        padding-left: 15px;
        margin-bottom: 25px;
    }
    .error-message {
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.25rem;
        display: block;
    }
    .alert-custom {
        border-radius: 10px;
        border: 1px solid;
        animation: slideDown 0.3s ease;
    }
    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    .is-invalid {
        border-color: #dc3545;
        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
    }
</style>
<body class="bg-light">
    <div class="container py-4">

        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card form-card">
                    <div class="card-header form-header text-white py-3">
                        <h3 class="card-title mb-0"><i class="fas fa-plus-circle me-2"></i>Регистрация</h3>
                    </div>
                    <div class="card-body p-4">
                        <!-- Блок для отображения ошибок -->
                        {% if error %}
                        <div class="alert alert-danger alert-custom alert-dismissible fade show" role="alert">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Ошибка:</strong> {{ error }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                        {% endif %}

                        <form action="/register/" method="post">
                            <div class="form-section">
                                <h5 class="text-primary mb-3"><i class="fas fa-info-circle me-2"></i>Основная информация</h5>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="full_name" class="form-label required-label">ФИО</label>
                                        <input type="text"
                                               class="form-control {% if error and 'фио' in error.lower() %}is-invalid{% endif %}"
                                               id="full_name"
                                               name="full_name"
                                               value="{{ form_data.full_name if form_data else '' }}"
                                               required
                                               placeholder="Иванов Иван Иванович">
                                        {% if error and 'фио' in error.lower() %}
                                            <span class="error-message">
                                                <i class="fas fa-exclamation-circle me-1"></i>
                                                {{ error }}
                                            </span>
                                        {% endif %}
                                    </div>
                                    <div class="col-md-6">
                                        <label for="password" class="form-label required-label">Пароль</label>
                                        <input type="password"
                                               class="form-control"
                                               id="password"
                                               name="password"
                                               value="{{ form_data.password if form_data else '' }}"
                                               required
                                               placeholder="Введите пароль">
                                        <div class="form-text">Пароль должен содержать не менее 6 символов</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="phone_number" class="form-label required-label">Моб. телефон</label>
                                        <input type="text"
                                               class="form-control"
                                               id="phone_number"
                                               name="phone_number"
                                               value="{{ form_data.phone_number if form_data else '' }}"
                                               required
                                               placeholder="+7 (XXX) XXX-XX-XX">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="email" class="form-label required-label">Электронная почта</label>
                                        <input type="text"
                                               class="form-control"
                                               id="email"
                                               name="email"
                                               value="{{ form_data.email if form_data else '' }}"
                                               required
                                               placeholder="ivanivanov@yandex.ru">
                                    </div>
                                </div>
                            </div>

                            <div class="row mt-4">
                                <div class="col-12 d-flex justify-content-between">
                                    <a href="/form-login" class="btn btn-secondary btn-lg">
                                        <i class="fas fa-arrow-left me-2"></i>Назад к авторизации
                                    </a>
                                    <button type="submit" class="btn btn-primary btn-lg">
                                        <i class="fas fa-save me-2"></i>Зарегистрироваться
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Скрипт для маски телефона -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/inputmask/5.0.8/jquery.inputmask.min.js"></script>
    <script>
        $(document).ready(function() {
            // Маска для телефона
            $('#phone_number').inputmask({
                mask: '+7 (999) 999-99-99',
                placeholder: '_',
                clearIncomplete: true,
                showMaskOnHover: true
            });

            // Автофокус на поле с ошибкой
            {% if error and 'фио' in error.lower() %}
                document.getElementById('full_name').focus();
            {% endif %}

            // Скрытие алерта через 5 секунд
            setTimeout(function() {
                var alerts = document.querySelectorAll('.alert');
                alerts.forEach(function(alert) {
                    var bsAlert = new bootstrap.Alert(alert);
                    bsAlert.close();
                });
            }, 5000);
        });
    </script>
</body>
</html>